# API Investigation — How I Discovered Airline APIs

> This document explains the methodology used to investigate airline APIs for this project. It demonstrates reverse-engineering skills using browser DevTools — a valuable technique for any developer working with web services.

## Methodology

For each airline, I followed the same process:

1. **Open the airline's website** and navigate to their flight search page
2. **Open Chrome DevTools** (`F12`) → Network tab → filter by `Fetch/XHR`
3. **Perform a flight search** and observe the network requests
4. **Analyze each request**: URL, method (GET/POST), headers, request body, and response
5. **Identify authentication**: Does it need tokens? Cookies? API keys? Captchas?
6. **Test replicability**: Can I reproduce the request from a script without a browser?

## Results by Airline

### ✅ Level Airlines — Fully Open API

**Discovery:** When searching for flights on flylevel.com, a GET request fires to their calendar API. The response is clean JSON with daily prices for the entire month.

**Key finding:** No authentication whatsoever. The endpoint accepts any origin/destination IATA codes and returns prices. The API is documented in their NDC API docs (through Vueling's infrastructure).

**Endpoint:** `GET /nwe/flights/api/calendar/?triptype=RT&origin=EZE&destination=BCN&month=12&year=2026&currencyCode=USD`

**Why it works for the bot:** One request per month gives us 30+ days of prices. Perfect for a cron job that runs every 6 hours.

---

### ✅ Sky Airline — Public API Key

**Discovery:** Sky's frontend makes POST requests to an Azure API Management endpoint. The API key is visible in the JavaScript bundle and passed as the `ocp-apim-subscription-key` header.

**Key finding:** The API key is static and public (hardcoded in their frontend). No cookies, no session management, no captcha. The `dateFlexibility` parameter is powerful — setting it to 14 returns ±14 days of data in a single request.

**Endpoint:** `POST https://api.skyairline.com/shopping-lowest-fares/lowest-fares/v1/search`

**Risk:** The API key could be rotated at any time. The bot handles this gracefully by detecting 401/403 errors and sending a one-time notification.

---

### ❌ Gol — JWT + Akamai Bot Manager

**Discovery:** Gol's search API requires a Bearer JWT token that expires periodically. More critically, the site uses Akamai Bot Manager, which sets cookies like `_abck`, `bm_sv`, and `ak_bmsc` that are generated by JavaScript fingerprinting.

**Why it's not viable:** Replicating Akamai's bot detection from a simple HTTP client would require a full browser automation setup, which defeats the purpose of a lightweight cron job.

---

### ❌ LATAM — Captcha + JWT + Akamai

**Discovery:** LATAM's API requires three layers of protection:
1. `x-latam-captcha-token` — An invisible reCAPTCHA token
2. `x-latam-search-token` — A JWT that expires in 1200 seconds (20 minutes)
3. Akamai Bot Manager cookies

**Interesting finding:** The JWT payload contains the message: *"Hi Hacker friend, if you need to see our offers out of our site, feel free to contact us."* This suggests LATAM may offer a legitimate API access program.

**Why it's not viable:** The combination of captcha + short-lived JWT + bot detection makes automated access impractical without significant infrastructure.

---

### ⚠️ JetSmart — Session-Based

**Discovery:** JetSmart uses ASP.NET session management. Accessing their API requires:
1. First performing a search on their website to establish a session
2. Then using the session cookies (`ASP.NET_SessionId`, `__RequestVerificationToken`) to fetch data

**Why it's not implemented:** While technically possible, the session-based approach is fragile. Sessions expire, and maintaining them from a cron job adds complexity. Google Flights covers JetSmart routes as a fallback.

---

### ❌ Aerolíneas Argentinas — API Not Visible

**Discovery:** Unlike other airlines, Aerolíneas Argentinas' flight search doesn't expose clear API calls in the DevTools Network tab. The data loading mechanism appears to be server-rendered or obfuscated.

**Why it's not viable:** Without visible API endpoints, there's nothing to reverse-engineer. Google Flights covers their routes.

## Lessons Learned

1. **Not all airlines expose their APIs equally.** Some have clean REST endpoints, others hide behind multiple layers of protection.
2. **Azure API Management keys in frontend code are essentially public.** If it's in the JavaScript bundle, it's accessible.
3. **Akamai Bot Manager is the most common barrier.** It's used by both Gol and LATAM.
4. **Aggregators (Google Flights) provide the best coverage** but with less granularity than direct APIs.
5. **The dual-source strategy** (direct APIs + Google Flights fallback) provides the best balance of reliability and coverage.
